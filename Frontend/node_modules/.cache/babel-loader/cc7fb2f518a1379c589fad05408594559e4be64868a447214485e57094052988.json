{"ast":null,"code":"// import { useParams } from \"react-router-dom\";\n// import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\n// import { useSelector } from \"react-redux\";\n// import { useState, useEffect, useRef } from \"react\";\n// import {fetchMessages,sendMessage,fetchConversationMeta,fetchUserById} from \"../Tanstack/Chatlist\";\n\n// const ChatDashboard = () => {\n//   const { conversationId } = useParams();\n//   const currentUser = useSelector((state) => state.auth.user);\n//   const queryClient = useQueryClient();\n//   const [text, setText] = useState(\"\");\n//   const bottomRef = useRef(null);\n\n//   /* ðŸ”¹ Conversation meta */\n//   const { data: convo } = useQuery({\n//     queryKey: [\"conversation-meta\", conversationId],\n//     queryFn: () => fetchConversationMeta(conversationId),\n//     enabled: !!conversationId,\n//   });\n\n//   /* ðŸ”¹ Receiver user */\n//   const { data: receiver } = useQuery({\n//     queryKey: [\"user\", convo?.receiver_id],\n//     queryFn: () => fetchUserById(convo.receiver_id),\n//     enabled: !!convo?.receiver_id,\n//   });\n\n//   /* ðŸ”¹ Messages */\n//   const { data: messages = [], isLoading } = useQuery({\n//     queryKey: [\"messages\", conversationId],\n//     queryFn: () => fetchMessages(conversationId),\n//     enabled: !!conversationId,\n//   });\n\n//   const sendMessageMutation = useMutation({\n//     mutationFn: sendMessage,\n//     onSuccess: () => {\n//       queryClient.invalidateQueries({\n//         queryKey: [\"messages\", conversationId],\n//       });\n//       setText(\"\");\n//     },\n//   });\n\n//   useEffect(() => {\n//     bottomRef.current?.scrollIntoView({ behavior: \"smooth\" });\n//   }, [messages]);\n\n//   if (isLoading) {\n//     return (\n//       <div className=\"flex-1 flex items-center justify-center\">\n//         <span style={{ color: \"var(--text-muted)\" }}>Loading chatâ€¦</span>\n//       </div>\n//     );\n//   }\n\n//   return (\n//     <div className=\"flex-1 flex flex-col\">\n//       {/* HEADER */}\n//       <div\n//         className=\"px-4 py-3 border-b font-semibold flex items-center gap-3\"\n//         style={{\n//           borderColor: \"var(--border-main)\",\n//           backgroundColor: \"var(--bg-card)\",\n//           color: \"var(--text-main)\",\n//         }}\n//       >\n//         <div\n//           className=\"w-9 h-9 rounded-full flex items-center justify-center font-semibold\"\n//           style={{\n//             backgroundColor: \"var(--accent-secondary)\",\n//             color: \"#020617\",\n//           }}\n//         >\n//           {receiver?.user_name?.charAt(0) || \"?\"}\n//         </div>\n\n//         <span>{receiver?.user_name || \"Chat\"}</span>\n//       </div>\n\n//       {/* MESSAGES */}\n//       <div className=\"flex-1 overflow-y-auto p-4 space-y-3\">\n//         {messages.length === 0 ? (\n//           <p\n//             className=\"text-center text-sm mt-10\"\n//             style={{ color: \"var(--text-muted)\" }}\n//           >\n//             No messages yet. Say hello ðŸ‘‹\n//           </p>\n//         ) : (\n//           messages.map((msg) => {\n//             const isMe = msg.sender_id === currentUser?.auth_id;\n\n//             return (\n//               <div\n//                 key={msg.id}\n//                 className={`max-w-xs px-4 py-2 rounded-lg text-sm ${\n//                   isMe ? \"ml-auto\" : \"mr-auto\"\n//                 }`}\n//                 style={{\n//                   backgroundColor: isMe\n//                     ? \"var(--accent-primary)\"\n//                     : \"var(--bg-input)\",\n//                   color: isMe ? \"#020617\" : \"var(--text-main)\",\n//                 }}\n//               >\n//                 {msg.text}\n//               </div>\n//             );\n//           })\n//         )}\n//         <div ref={bottomRef} />\n//       </div>\n\n//       {/* INPUT */}\n//       <form\n//         onSubmit={(e) => {\n//           e.preventDefault();\n//           if (!text.trim()) return;\n//           sendMessageMutation.mutate({ conversationId, text });\n//         }}\n//         className=\"p-3 border-t flex gap-2\"\n//         style={{\n//           borderColor: \"var(--border-main)\",\n//           backgroundColor: \"var(--bg-card)\",\n//         }}\n//       >\n//         <input\n//           value={text}\n//           onChange={(e) => setText(e.target.value)}\n//           placeholder=\"Type a message...\"\n//           className=\"flex-1 px-4 py-2 rounded-md outline-none\"\n//           style={{\n//             backgroundColor: \"var(--bg-input)\",\n//             color: \"var(--text-main)\",\n//             border: \"1px solid var(--border-input)\",\n//           }}\n//         />\n\n//         <button\n//           type=\"submit\"\n//           disabled={sendMessageMutation.isLoading}\n//           className=\"px-4 py-2 rounded-md font-medium\"\n//           style={{\n//             backgroundColor: \"var(--accent-primary)\",\n//             color: \"#020617\",\n//           }}\n//         >\n//           Send\n//         </button>\n//       </form>\n//     </div>\n//   );\n// };\n\n// export default ChatDashboard;","map":{"version":3,"names":[],"sources":["C:/Users/prath/OneDrive/Documents/Web_projects/Talkify/Frontend/src/Component/Chat/ChatDashboard.js"],"sourcesContent":["// import { useParams } from \"react-router-dom\";\r\n// import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\r\n// import { useSelector } from \"react-redux\";\r\n// import { useState, useEffect, useRef } from \"react\";\r\n// import {fetchMessages,sendMessage,fetchConversationMeta,fetchUserById} from \"../Tanstack/Chatlist\";\r\n\r\n// const ChatDashboard = () => {\r\n//   const { conversationId } = useParams();\r\n//   const currentUser = useSelector((state) => state.auth.user);\r\n//   const queryClient = useQueryClient();\r\n//   const [text, setText] = useState(\"\");\r\n//   const bottomRef = useRef(null);\r\n\r\n//   /* ðŸ”¹ Conversation meta */\r\n//   const { data: convo } = useQuery({\r\n//     queryKey: [\"conversation-meta\", conversationId],\r\n//     queryFn: () => fetchConversationMeta(conversationId),\r\n//     enabled: !!conversationId,\r\n//   });\r\n\r\n//   /* ðŸ”¹ Receiver user */\r\n//   const { data: receiver } = useQuery({\r\n//     queryKey: [\"user\", convo?.receiver_id],\r\n//     queryFn: () => fetchUserById(convo.receiver_id),\r\n//     enabled: !!convo?.receiver_id,\r\n//   });\r\n\r\n//   /* ðŸ”¹ Messages */\r\n//   const { data: messages = [], isLoading } = useQuery({\r\n//     queryKey: [\"messages\", conversationId],\r\n//     queryFn: () => fetchMessages(conversationId),\r\n//     enabled: !!conversationId,\r\n//   });\r\n\r\n//   const sendMessageMutation = useMutation({\r\n//     mutationFn: sendMessage,\r\n//     onSuccess: () => {\r\n//       queryClient.invalidateQueries({\r\n//         queryKey: [\"messages\", conversationId],\r\n//       });\r\n//       setText(\"\");\r\n//     },\r\n//   });\r\n\r\n//   useEffect(() => {\r\n//     bottomRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n//   }, [messages]);\r\n\r\n//   if (isLoading) {\r\n//     return (\r\n//       <div className=\"flex-1 flex items-center justify-center\">\r\n//         <span style={{ color: \"var(--text-muted)\" }}>Loading chatâ€¦</span>\r\n//       </div>\r\n//     );\r\n//   }\r\n\r\n//   return (\r\n//     <div className=\"flex-1 flex flex-col\">\r\n//       {/* HEADER */}\r\n//       <div\r\n//         className=\"px-4 py-3 border-b font-semibold flex items-center gap-3\"\r\n//         style={{\r\n//           borderColor: \"var(--border-main)\",\r\n//           backgroundColor: \"var(--bg-card)\",\r\n//           color: \"var(--text-main)\",\r\n//         }}\r\n//       >\r\n//         <div\r\n//           className=\"w-9 h-9 rounded-full flex items-center justify-center font-semibold\"\r\n//           style={{\r\n//             backgroundColor: \"var(--accent-secondary)\",\r\n//             color: \"#020617\",\r\n//           }}\r\n//         >\r\n//           {receiver?.user_name?.charAt(0) || \"?\"}\r\n//         </div>\r\n\r\n//         <span>{receiver?.user_name || \"Chat\"}</span>\r\n//       </div>\r\n\r\n//       {/* MESSAGES */}\r\n//       <div className=\"flex-1 overflow-y-auto p-4 space-y-3\">\r\n//         {messages.length === 0 ? (\r\n//           <p\r\n//             className=\"text-center text-sm mt-10\"\r\n//             style={{ color: \"var(--text-muted)\" }}\r\n//           >\r\n//             No messages yet. Say hello ðŸ‘‹\r\n//           </p>\r\n//         ) : (\r\n//           messages.map((msg) => {\r\n//             const isMe = msg.sender_id === currentUser?.auth_id;\r\n\r\n//             return (\r\n//               <div\r\n//                 key={msg.id}\r\n//                 className={`max-w-xs px-4 py-2 rounded-lg text-sm ${\r\n//                   isMe ? \"ml-auto\" : \"mr-auto\"\r\n//                 }`}\r\n//                 style={{\r\n//                   backgroundColor: isMe\r\n//                     ? \"var(--accent-primary)\"\r\n//                     : \"var(--bg-input)\",\r\n//                   color: isMe ? \"#020617\" : \"var(--text-main)\",\r\n//                 }}\r\n//               >\r\n//                 {msg.text}\r\n//               </div>\r\n//             );\r\n//           })\r\n//         )}\r\n//         <div ref={bottomRef} />\r\n//       </div>\r\n\r\n//       {/* INPUT */}\r\n//       <form\r\n//         onSubmit={(e) => {\r\n//           e.preventDefault();\r\n//           if (!text.trim()) return;\r\n//           sendMessageMutation.mutate({ conversationId, text });\r\n//         }}\r\n//         className=\"p-3 border-t flex gap-2\"\r\n//         style={{\r\n//           borderColor: \"var(--border-main)\",\r\n//           backgroundColor: \"var(--bg-card)\",\r\n//         }}\r\n//       >\r\n//         <input\r\n//           value={text}\r\n//           onChange={(e) => setText(e.target.value)}\r\n//           placeholder=\"Type a message...\"\r\n//           className=\"flex-1 px-4 py-2 rounded-md outline-none\"\r\n//           style={{\r\n//             backgroundColor: \"var(--bg-input)\",\r\n//             color: \"var(--text-main)\",\r\n//             border: \"1px solid var(--border-input)\",\r\n//           }}\r\n//         />\r\n\r\n//         <button\r\n//           type=\"submit\"\r\n//           disabled={sendMessageMutation.isLoading}\r\n//           className=\"px-4 py-2 rounded-md font-medium\"\r\n//           style={{\r\n//             backgroundColor: \"var(--accent-primary)\",\r\n//             color: \"#020617\",\r\n//           }}\r\n//         >\r\n//           Send\r\n//         </button>\r\n//       </form>\r\n//     </div>\r\n//   );\r\n// };\r\n\r\n// export default ChatDashboard;\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}